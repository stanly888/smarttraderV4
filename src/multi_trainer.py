# Core training loop for multi-strategy